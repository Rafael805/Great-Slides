<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=1920, height=1080, initial-scale=1" />
  <title>Retainer vs Pay Per Lead Agency Model</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg: #0f0d0a;
      --surface: #161310;
      --card-bg: #1c1915;
      --card-border: #2e2820;
      --primary: #C7963F;
      --primary-glow: rgba(199, 150, 63, 0.15);
      --secondary: #7c3aed;
      --text: #ffffff;
      --text-muted: #9a9080;
      --text-accent: #C7963F;
      --success: #10b981;
      --warning: #f59e0b;
      --error: #ef4444;
      --font-heading: Inter, system-ui, sans-serif;
      --font-body: Inter, system-ui, sans-serif;
      --font-mono: JetBrains Mono, monospace;
      --title-size: 3.5rem;
      --heading-size: 2.5rem;
      --subheading-size: 1.5rem;
      --body-size: 1.125rem;
      --bullet-size: 1.25rem;
      --caption-size: 0.875rem;
      --content-padding: 80px;
      --card-radius: 16px;
      --sidebar-width: 260px;
      --transition-duration: 300ms;
    }

    /* ==========================================================================
       HTML Slide Designer - Base Theme
       ========================================================================== */

    /* ---------- Reset & Base ---------- */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: var(--bg);
      color: var(--text);
      font-family: var(--font-body);
      font-size: var(--body-size);
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* ---------- Presentation Container ---------- */
    .presentation {
      display: flex;
      width: 100vw;
      height: 100vh;
    }

    /* ---------- Sidebar Navigation ---------- */
    .sidebar {
      width: var(--sidebar-width);
      min-width: var(--sidebar-width);
      background: var(--surface);
      border-right: 1px solid var(--card-border);
      display: flex;
      flex-direction: column;
      padding: 32px 0;
      overflow-y: auto;
      z-index: 10;
      transition: transform var(--transition-duration) ease;
    }

    .sidebar--hidden {
      transform: translateX(calc(-1 * var(--sidebar-width)));
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
    }

    .sidebar__logo {
      padding: 0 24px 32px;
      border-bottom: 1px solid var(--card-border);
      margin-bottom: 24px;
    }

    .sidebar__logo img {
      max-width: 120px;
      height: auto;
    }

    .sidebar__nav {
      list-style: none;
      padding: 0 12px;
      flex: 1;
    }

    .sidebar__item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 150ms ease;
      margin-bottom: 4px;
      font-size: var(--caption-size);
      color: var(--text-muted);
      font-weight: 500;
    }

    .sidebar__item:hover {
      background: rgba(255, 255, 255, 0.05);
      color: var(--text);
    }

    .sidebar__item--active {
      background: var(--primary-glow);
      color: var(--primary);
      font-weight: 600;
    }

    .sidebar__item-number {
      font-family: var(--font-mono);
      font-size: 0.75rem;
      font-weight: 700;
      min-width: 28px;
      text-align: center;
    }

    .sidebar__item-label {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Progress bar at bottom of sidebar */
    .sidebar__progress {
      padding: 16px 24px;
      border-top: 1px solid var(--card-border);
      margin-top: auto;
    }

    .sidebar__progress-bar {
      width: 100%;
      height: 3px;
      background: var(--card-border);
      border-radius: 2px;
      overflow: hidden;
    }

    .sidebar__progress-fill {
      height: 100%;
      background: var(--primary);
      border-radius: 2px;
      transition: width var(--transition-duration) ease;
    }

    .sidebar__progress-text {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 8px;
      text-align: center;
    }

    /* ---------- Slide Stage ---------- */
    .stage {
      flex: 1;
      position: relative;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #ffffff;
    }

    /* ---------- Slides ---------- */
    .slide {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity var(--transition-duration) ease;
      padding: var(--content-padding);
    }

    .slide--active {
      opacity: 1;
      pointer-events: auto;
    }

    /* Slide content wrapper */
    .slide__content {
      width: 100%;
      max-width: 1400px;
      display: flex;
      flex-direction: column;
      gap: 32px;
      align-items: center;
      text-align: center;
    }

    .slide__content--centered {
      align-items: center;
      text-align: center;
    }

    .slide__content--split {
      flex-direction: row;
      align-items: center;
      gap: 64px;
    }

    /* Full-width elements in centered content */
    .slide__stats-grid,
    .slide__cards {
      width: 100%;
    }

    /* Keep list text left-aligned */
    .slide__bullets,
    .slide__takeaways {
      text-align: left;
    }

    /* ---------- Typography ---------- */
    .slide__title {
      font-family: var(--font-heading);
      font-size: var(--title-size);
      font-weight: 700;
      line-height: 1.1;
      color: #1a1a1a;
      letter-spacing: -0.02em;
    }

    .slide__heading {
      font-family: var(--font-heading);
      font-size: var(--heading-size);
      font-weight: 700;
      line-height: 1.2;
      color: #1a1a1a;
      letter-spacing: -0.01em;
    }

    .slide__heading--overlay {
      text-shadow: 0 2px 12px rgba(0, 0, 0, 0.8);
    }

    .slide__subheading {
      font-size: var(--subheading-size);
      font-weight: 500;
      color: #666666;
      line-height: 1.4;
    }

    .slide__subheading--overlay {
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.8);
      color: #ffffff;
    }

    .slide__subtitle {
      font-size: var(--subheading-size);
      font-weight: 400;
      color: #666666;
      margin-top: -16px;
    }

    .slide__description {
      font-size: var(--body-size);
      color: #666666;
      line-height: 1.6;
    }

    /* ---------- Logo ---------- */
    .slide__logo {
      max-width: 160px;
      height: auto;
      margin-bottom: 24px;
    }

    /* ---------- Badges ---------- */
    .badge {
      display: inline-flex;
      align-items: center;
      padding: 6px 16px;
      border-radius: 100px;
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      width: fit-content;
    }

    .badge--step {
      border: 1.5px solid var(--primary);
      background: transparent;
      color: var(--primary);
    }

    .badge--recommended {
      border: 1.5px solid var(--primary);
      background: var(--primary);
      color: var(--bg);
    }

    /* ---------- Bullets ---------- */
    .slide__bullets {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .slide__bullet {
      font-size: var(--bullet-size);
      font-weight: 400;
      color: #1a1a1a;
      padding-left: 28px;
      position: relative;
      line-height: 1.5;
    }

    .slide__bullet::before {
      content: '';
      position: absolute;
      left: 0;
      top: 10px;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--primary);
    }

    /* ---------- Split Layout ---------- */
    .slide__text-side {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    .slide__image-side {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .slide__image {
      max-width: 100%;
      max-height: 75vh;
      border-radius: var(--card-radius);
      object-fit: cover;
    }

    /* Full-width hero image (centered below heading - AI generated images) */
    .slide__hero-image {
      width: 100%;
      max-height: 55vh;
      border-radius: var(--card-radius);
      object-fit: contain;
      display: block;
      margin: 0 auto;
    }

    /* Reverse order for image on left */
    .slide--image-left .slide__content--split {
      flex-direction: row;
    }

    .slide--image-right .slide__content--split {
      flex-direction: row-reverse;
    }

    /* ---------- Cards ---------- */
    .slide__cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 24px;
    }

    .card {
      background: #f8f9fa;
      border: 1px solid #e0e0e0;
      border-radius: var(--card-radius);
      overflow: hidden;
      transition: transform 150ms ease, box-shadow 150ms ease;
    }

    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 32px var(--primary-glow);
    }

    .card__image-wrapper {
      width: 100%;
      aspect-ratio: 1;
      overflow: hidden;
      background: #f0f0f0;
    }

    .card__image {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .card__body {
      padding: 24px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .card__title {
      font-family: var(--font-heading);
      font-size: var(--subheading-size);
      font-weight: 600;
      color: #1a1a1a;
    }

    .card__description {
      font-size: var(--body-size);
      color: #666666;
      line-height: 1.5;
    }

    /* ---------- Full Image ---------- */
    .slide--full-image {
      padding: 0;
    }

    .slide__bg-image {
      position: absolute;
      inset: 0;
      background-size: cover;
      background-position: center;
      z-index: 0;
    }

    .slide__overlay {
      position: absolute;
      inset: 0;
      z-index: 1;
      display: flex;
      padding: var(--content-padding);
    }

    .slide__overlay--top {
      align-items: flex-start;
      background: linear-gradient(to bottom, rgba(0, 0, 0, 0.85) 0%, transparent 80%);
    }

    .slide__overlay--center {
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.6);
    }

    .slide__overlay--bottom {
      align-items: flex-end;
      background: linear-gradient(to top, rgba(0, 0, 0, 0.85) 0%, transparent 80%);
    }

    /* ---------- Diagram ---------- */
    .slide__diagram-wrapper {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 550px;
      width: 100%;
    }

    .slide__diagram-wrapper .mermaid {
      width: 100%;
      min-height: 500px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .slide__diagram-wrapper .mermaid svg {
      min-height: 450px;
      width: 100% !important;
      max-width: 100%;
    }

    .slide__svg-diagram {
      width: 100%;
      display: flex;
      justify-content: center;
    }

    .slide__svg-diagram svg {
      max-width: 100%;
      max-height: 600px;
      min-height: 450px;
    }

    /* ---------- Quote ---------- */
    .slide__quote-wrapper {
      max-width: 900px;
      position: relative;
    }

    .slide__quote-mark {
      font-family: Georgia, serif;
      font-size: 8rem;
      color: var(--primary);
      opacity: 0.3;
      line-height: 1;
      position: absolute;
      top: -40px;
      left: -20px;
    }

    .slide__quote {
      font-family: var(--font-heading);
      font-size: var(--heading-size);
      font-weight: 500;
      font-style: italic;
      line-height: 1.4;
      color: #1a1a1a;
      position: relative;
      z-index: 1;
    }

    .slide__attribution {
      display: block;
      margin-top: 24px;
      font-size: var(--body-size);
      font-style: normal;
      color: #666666;
    }

    /* ---------- Stats ---------- */
    .slide__stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 32px;
    }

    .stat-card {
      background: #f8f9fa;
      border: 1px solid #e0e0e0;
      border-radius: var(--card-radius);
      padding: 40px 32px;
      text-align: center;
    }

    .stat-card__value {
      font-family: var(--font-heading);
      font-size: var(--title-size);
      font-weight: 700;
      color: var(--primary);
      line-height: 1;
      margin-bottom: 8px;
    }

    .stat-card__label {
      font-size: var(--subheading-size);
      font-weight: 600;
      color: #1a1a1a;
      margin-bottom: 8px;
    }

    .stat-card__description {
      font-size: var(--caption-size);
      color: #666666;
    }

    /* ---------- Recap / Summary ---------- */
    .slide__takeaways {
      list-style: none;
      counter-reset: takeaway;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .slide__takeaway {
      counter-increment: takeaway;
      font-size: var(--bullet-size);
      color: #1a1a1a;
      padding-left: 48px;
      position: relative;
      line-height: 1.5;
    }

    .slide__takeaway::before {
      content: counter(takeaway);
      position: absolute;
      left: 0;
      top: 0;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--primary-glow);
      color: var(--primary);
      font-family: var(--font-mono);
      font-size: 0.875rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* ---------- CTA ---------- */
    .slide__cta {
      margin-top: 16px;
    }

    .slide__cta-link {
      display: inline-flex;
      align-items: center;
      padding: 14px 32px;
      background: var(--primary);
      color: var(--bg);
      border-radius: 100px;
      font-weight: 600;
      font-size: var(--body-size);
      text-decoration: none;
      transition: transform 150ms ease, box-shadow 150ms ease;
    }

    .slide__cta-link:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 32px var(--primary-glow);
    }

    .slide__cta-text {
      font-size: var(--subheading-size);
      color: var(--primary);
      font-weight: 600;
    }

    /* ---------- Image Placeholder (fallback) ---------- */
    .image-placeholder {
      background: #f8f9fa;
      border: 2px dashed #e0e0e0;
      border-radius: var(--card-radius);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px;
      color: #666666;
      font-style: italic;
      font-size: var(--caption-size);
    }

    /* ---------- Edit Mode ---------- */
    .edit-mode .slide__title,
    .edit-mode .slide__heading,
    .edit-mode .slide__subheading,
    .edit-mode .slide__subtitle,
    .edit-mode .slide__description,
    .edit-mode .slide__bullet,
    .edit-mode .slide__quote,
    .edit-mode .slide__attribution,
    .edit-mode .card__title,
    .edit-mode .card__description,
    .edit-mode .stat-card__value,
    .edit-mode .stat-card__label,
    .edit-mode .stat-card__description,
    .edit-mode .slide__takeaway,
    .edit-mode .slide__cta-text,
    .edit-mode .badge {
      outline: 1px dashed rgba(0, 0, 0, 0.15);
      outline-offset: 4px;
      cursor: text;
    }

    .edit-mode [contenteditable="true"]:focus {
      outline: 2px solid var(--primary);
      outline-offset: 4px;
      border-radius: 4px;
    }

    .edit-mode .slide__image,
    .edit-mode .card__image-wrapper {
      position: relative;
      cursor: pointer;
    }

    .edit-mode .image-replace-overlay {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 150ms ease;
      border-radius: var(--card-radius);
      pointer-events: none;
    }

    .edit-mode .slide__image:hover + .image-replace-overlay,
    .edit-mode .image-replace-overlay:hover {
      opacity: 1;
      pointer-events: auto;
    }

    .image-replace-btn {
      padding: 8px 20px;
      background: var(--primary);
      color: var(--bg);
      border: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 0.875rem;
      cursor: pointer;
    }

    /* ---------- Edit Toolbar ---------- */
    .edit-toolbar {
      position: fixed;
      top: 0;
      left: var(--sidebar-width);
      right: 0;
      height: 48px;
      background: var(--surface);
      border-bottom: 1px solid var(--card-border);
      display: none;
      align-items: center;
      padding: 0 24px;
      gap: 8px;
      z-index: 100;
    }

    .edit-mode .edit-toolbar {
      display: flex;
    }

    .edit-toolbar__btn {
      padding: 6px 12px;
      background: transparent;
      border: 1px solid var(--card-border);
      border-radius: 6px;
      color: var(--text);
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 150ms ease;
    }

    .edit-toolbar__btn:hover {
      background: var(--card-bg);
      border-color: var(--primary);
    }

    .edit-toolbar__btn--active {
      background: var(--primary-glow);
      border-color: var(--primary);
      color: var(--primary);
    }

    .edit-toolbar__separator {
      width: 1px;
      height: 24px;
      background: var(--card-border);
      margin: 0 4px;
    }

    .edit-toolbar__spacer {
      flex: 1;
    }

    .edit-toolbar__btn--save {
      background: var(--primary);
      color: var(--bg);
      border-color: var(--primary);
      font-weight: 600;
    }

    .edit-toolbar__btn--save:hover {
      opacity: 0.9;
    }

    .edit-toolbar__btn--danger {
      color: var(--error);
      border-color: var(--error);
    }

    .edit-toolbar__btn--danger:hover {
      background: rgba(239, 68, 68, 0.15);
      border-color: var(--error);
    }

    /* ---------- Drag and Drop (Edit Mode) ---------- */
    .edit-mode .slide__content > * {
      position: relative;
    }

    .drag-handle {
      position: absolute;
      left: -40px;
      top: 50%;
      transform: translateY(-50%);
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-muted);
      cursor: grab;
      opacity: 0;
      transition: opacity 150ms ease;
      user-select: none;
      z-index: 10;
    }

    .drag-handle::before {
      content: '';
      display: block;
      width: 8px;
      height: 14px;
      background-image: radial-gradient(circle, currentColor 1.5px, transparent 1.5px);
      background-size: 4px 4.5px;
    }

    .edit-mode .slide__content > *:hover > .drag-handle {
      opacity: 0.5;
    }

    .drag-handle:hover {
      opacity: 1 !important;
      color: var(--primary);
    }

    .edit-mode .slide__content > .dragging {
      opacity: 0.3;
    }

    /* ---------- Edit Mode Indicator ---------- */
    .edit-indicator {
      position: fixed;
      bottom: 16px;
      right: 16px;
      padding: 8px 16px;
      background: var(--primary);
      color: var(--bg);
      border-radius: 8px;
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      z-index: 100;
      display: none;
    }

    .edit-mode .edit-indicator {
      display: block;
    }

    /* ---------- Fullscreen adjustments ---------- */
    .presentation--fullscreen .sidebar {
      display: none;
    }

    /* ---------- Mermaid dark theme overrides ---------- */
    .mermaid {
      font-family: var(--font-body) !important;
    }

    /* ---------- Save Toast ---------- */
    .save-toast {
      position: fixed;
      top: 24px;
      right: 24px;
      padding: 12px 24px;
      background: var(--success, #22c55e);
      color: #ffffff;
      border-radius: 8px;
      font-size: 0.875rem;
      font-weight: 600;
      font-family: var(--font-body);
      z-index: 300;
      opacity: 0;
      transform: translateY(-12px);
      transition: opacity 300ms ease, transform 300ms ease;
      pointer-events: none;
    }

    .save-toast--visible {
      opacity: 1;
      transform: translateY(0);
    }

    .save-toast--error {
      background: var(--error, #ef4444);
    }

    /* ---------- Talking Points Panel ---------- */
    .notes-panel {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 360px;
      max-height: 280px;
      background: rgba(22, 19, 16, 0.95);
      border: 1px solid var(--card-border, #2e2820);
      border-radius: var(--card-radius, 16px);
      z-index: 200;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      font-family: var(--font-body);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }

    .notes-panel__header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 16px;
      border-bottom: 1px solid var(--card-border, #2e2820);
    }

    .notes-panel__title {
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--primary, #C7963F);
    }

    .notes-panel__hint {
      font-size: 0.625rem;
      font-family: var(--font-mono, monospace);
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-muted, #9a9080);
      padding: 2px 6px;
      border-radius: 4px;
    }

    .notes-panel__close {
      margin-left: auto;
      background: none;
      border: none;
      color: var(--text-muted, #9a9080);
      font-size: 1.25rem;
      cursor: pointer;
      padding: 0 4px;
      line-height: 1;
    }

    .notes-panel__close:hover {
      color: #ffffff;
    }

    .notes-panel__list {
      list-style: none;
      padding: 12px 16px;
      margin: 0;
      overflow-y: auto;
      flex: 1;
    }

    .notes-panel__item {
      font-size: 0.875rem;
      color: #ffffff;
      padding: 6px 0 6px 20px;
      position: relative;
      line-height: 1.4;
    }

    .notes-panel__item::before {
      content: '';
      position: absolute;
      left: 4px;
      top: 12px;
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--primary, #C7963F);
    }

    .notes-panel__empty {
      font-size: 0.875rem;
      color: var(--text-muted, #9a9080);
      font-style: italic;
      padding: 6px 0;
      list-style: none;
    }

    /* ---------- Responsive ---------- */
    @media (max-width: 1200px) {
      .slide__content--split {
        flex-direction: column;
        gap: 32px;
      }

      .slide__image-side {
        max-height: 40vh;
      }
    }
  </style>
</head>
<body>
  <div class="presentation">

    <!-- ===== Sidebar Navigation ===== -->
    <aside class="sidebar">
      <div class="sidebar__logo">
        <span style="font-family: var(--font-heading); font-weight: 700; font-size: 1rem; color: var(--primary);">Great Marketing AI</span>
      </div>
      <ul class="sidebar__nav">
        <li class="sidebar__item sidebar__item--active">
          <span class="sidebar__item-number">01</span>
          <span class="sidebar__item-label">Hook</span>
        </li>
        <li class="sidebar__item">
          <span class="sidebar__item-number">02</span>
          <span class="sidebar__item-label">The Problem</span>
        </li>
        <li class="sidebar__item">
          <span class="sidebar__item-number">03</span>
          <span class="sidebar__item-label">The Truth</span>
        </li>
        <li class="sidebar__item">
          <span class="sidebar__item-number">04</span>
          <span class="sidebar__item-label">Compare Models</span>
        </li>
        <li class="sidebar__item">
          <span class="sidebar__item-number">05</span>
          <span class="sidebar__item-label">The PPL Offer</span>
        </li>
        <li class="sidebar__item">
          <span class="sidebar__item-number">06</span>
          <span class="sidebar__item-label">Data Advantage</span>
        </li>
        <li class="sidebar__item">
          <span class="sidebar__item-number">07</span>
          <span class="sidebar__item-label">Operations</span>
        </li>
        <li class="sidebar__item">
          <span class="sidebar__item-number">08</span>
          <span class="sidebar__item-label">The Math</span>
        </li>
        <li class="sidebar__item">
          <span class="sidebar__item-number">09</span>
          <span class="sidebar__item-label">The Catch</span>
        </li>
        <li class="sidebar__item">
          <span class="sidebar__item-number">10</span>
          <span class="sidebar__item-label">Niche Scorecard</span>
        </li>
        <li class="sidebar__item">
          <span class="sidebar__item-number">11</span>
          <span class="sidebar__item-label">Sellable Asset</span>
        </li>
        <li class="sidebar__item">
          <span class="sidebar__item-number">12</span>
          <span class="sidebar__item-label">Key Takeaways</span>
        </li>
        <li class="sidebar__item">
          <span class="sidebar__item-number">13</span>
          <span class="sidebar__item-label">Next Steps</span>
        </li>
      </ul>
      <div class="sidebar__progress">
        <div class="sidebar__progress-bar">
          <div class="sidebar__progress-fill" style="width: 7.7%"></div>
        </div>
        <div class="sidebar__progress-text">1 / 13</div>
      </div>
    </aside>

    <!-- ===== Slide Stage ===== -->
    <main class="stage">

      <!-- ==================== SLIDE 1: Hook (Title Slide) ==================== -->
      <section class="slide slide--title slide--active" data-slide="1" data-chapter="Hook" data-notes="Open strong — this is the thesis of the entire video|Pause after 'sellable asset' to let it land|Set the stakes: this isn't theory, you're doing it right now">
        <div class="slide__content slide__content--centered">
          <div class="badge badge--step">Agency Model Shift</div>
          <h1 class="slide__title">The Retainer Treadmill<br>Is Killing Your Agency</h1>
          <p class="slide__subtitle">How to turn your agency from a service business into a sellable asset</p>
        </div>
      </section>

      <!-- ==================== SLIDE 2: The Problem ==================== -->
      <section class="slide slide--heading-bullets" data-slide="2" data-chapter="The Problem" data-notes="Paint the picture — make them feel the pain|Emphasize 'back to zero' — that's the gut punch|This is their daily reality, validate it">
        <div class="slide__content">
          <div class="badge badge--step">The Problem</div>
          <h2 class="slide__heading">The Retainer Treadmill</h2>
          <img class="slide__hero-image" src="images/slide-02-retainer-treadmill.png" alt="Stick figure running on a hamster wheel showing the retainer treadmill cycle" />
          <p class="slide__subheading">The never-ending cycle that traps agency owners</p>
          <ul class="slide__bullets">
            <li class="slide__bullet">Fight to land a client at $3K/mo</li>
            <li class="slide__bullet">Spend every day keeping them happy</li>
            <li class="slide__bullet">Client leaves — back to zero</li>
            <li class="slide__bullet">Repeat. Forever. Exhausting.</li>
          </ul>
        </div>
      </section>

      <!-- ==================== SLIDE 3: The Truth (Quote) ==================== -->
      <section class="slide slide--quote" data-slide="3" data-chapter="The Truth" data-notes="Let this line breathe — it's a mic drop moment|Pause 2 seconds after reading it|This reframes everything they thought about retainers">
        <div class="slide__content slide__content--centered">
          <div class="slide__quote-wrapper">
            <div class="slide__quote-mark">&ldquo;</div>
            <blockquote class="slide__quote">When you sign a retainer client, you're basically just an employee with a different tax code.</blockquote>
            <cite class="slide__attribution">The hard truth about retainer agencies</cite>
          </div>
        </div>
      </section>

      <!-- ==================== SLIDE 4: Compare Models (Card Grid) ==================== -->
      <section class="slide slide--card-grid" data-slide="4" data-chapter="Compare Models" data-notes="Walk through each card slowly|Stress the contrast between 'beg for trust' vs 'irresistible offer'|The upside column is the hook for the rest of the video">
        <div class="slide__content">
          <div class="badge badge--step">Model Comparison</div>
          <h2 class="slide__heading">Retainer vs Pay-Per-Lead</h2>
          <div class="slide__cards">
            <div class="card">
              <div class="card__body">
                <h3 class="card__title">Sales Pitch</h3>
                <p class="card__description"><strong>Retainer:</strong> "Trust me with $5K/mo and I'll try my best."</p>
                <p class="card__description"><strong>PPL:</strong> "You only pay for leads I deliver. No leads, no payment."</p>
              </div>
            </div>
            <div class="card">
              <div class="card__body">
                <h3 class="card__title">Risk</h3>
                <p class="card__description"><strong>Retainer:</strong> Client pays for ads. If ads flop, they lose money.</p>
                <p class="card__description"><strong>PPL:</strong> You pay for ads. If ads flop, you lose money.</p>
              </div>
            </div>
            <div class="card">
              <div class="card__body">
                <h3 class="card__title">Upside</h3>
                <p class="card__description"><strong>Retainer:</strong> Capped by your monthly fee. Limited growth.</p>
                <p class="card__description"><strong>PPL:</strong> Uncapped. More volume = more profit. No ceiling.</p>
                <span class="badge badge--recommended">Higher Upside</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ==================== SLIDE 5: The PPL Offer ==================== -->
      <section class="slide slide--heading-bullets" data-slide="5" data-chapter="The PPL Offer" data-notes="Deliver the pitch line like you're saying it to a prospect|'Feel stupid saying no' — pause and let it land|This is the moment they start thinking 'I want this'">
        <div class="slide__content">
          <div class="badge badge--step">The Offer</div>
          <h2 class="slide__heading">An Offer They Can't Refuse</h2>
          <img class="slide__hero-image" src="images/slide-05-irresistible-offer.png" alt="Agency making an irresistible pay-per-lead offer to a client" />
          <p class="slide__subheading">The PPL pitch eliminates buyer resistance</p>
          <ul class="slide__bullets">
            <li class="slide__bullet">No monthly retainer to justify</li>
            <li class="slide__bullet">Client pays only for delivered leads</li>
            <li class="slide__bullet">No leads = no payment. Zero risk for them.</li>
          </ul>
        </div>
      </section>

      <!-- ==================== SLIDE 6: Data Advantage ==================== -->
      <section class="slide slide--heading-bullets" data-slide="6" data-chapter="Data Advantage" data-notes="This is the 'aha moment' — stress ONE pixel vs twenty|Use hands to emphasize 'giant brain getting smarter'|This is the moat — the data asset they actually own">
        <div class="slide__content">
          <div class="badge badge--step">The Secret Weapon</div>
          <h2 class="slide__heading">One Pixel. One Giant Brain.</h2>
          <img class="slide__hero-image" src="images/slide-06-data-advantage.png" alt="One giant pixel brain vs twenty scattered small pixels" />
          <p class="slide__subheading">Every dollar you spend makes your targeting smarter</p>
          <ul class="slide__bullets">
            <li class="slide__bullet">Retainer: 20 clients = 20 scattered pixels</li>
            <li class="slide__bullet">PPL: 1 ad account, 1 pixel, 1 brain</li>
            <li class="slide__bullet">Each lead trains the algorithm to find cheaper leads</li>
            <li class="slide__bullet">You own the data asset — not the client</li>
          </ul>
        </div>
      </section>

      <!-- ==================== SLIDE 7: Operations ==================== -->
      <section class="slide slide--heading-bullets" data-slide="7" data-chapter="Operations" data-notes="Paint the retainer nightmare first — 10pm pings|Then contrast with the PPL calm — one funnel, one loop|Mention AI booking — it's the 5x multiplier">
        <div class="slide__content">
          <div class="badge badge--step">Operations</div>
          <h2 class="slide__heading">One Funnel. Every Client Benefits.</h2>
          <img class="slide__hero-image" src="images/slide-07-operations.png" alt="Chaos of retainer ops vs simplicity of PPL ops" />
          <p class="slide__subheading">Less work. More leverage. Better results.</p>
          <ul class="slide__bullets">
            <li class="slide__bullet">Own the funnel, landing pages, and sub-account</li>
            <li class="slide__bullet">One CRO change improves every client</li>
            <li class="slide__bullet">AI texts and books appointments automatically</li>
            <li class="slide__bullet">Leads become 5x more valuable</li>
          </ul>
        </div>
      </section>

      <!-- ==================== SLIDE 8: The Math (Stats) ==================== -->
      <section class="slide slide--stats" data-slide="8" data-chapter="The Math" data-notes="Let the numbers speak — read each one slowly|Stress 'uncapped' — that's what gets people excited|Compare to retainer: $3K/mo cap vs no cap here">
        <div class="slide__content">
          <div class="badge badge--step">Unit Economics</div>
          <h2 class="slide__heading">The PPL Math</h2>
          <div class="slide__stats-grid">
            <div class="stat-card">
              <div class="stat-card__value">$40</div>
              <div class="stat-card__label">Ad Spend per Lead</div>
              <div class="stat-card__description">Your cost to generate one qualified lead</div>
            </div>
            <div class="stat-card">
              <div class="stat-card__value">$150</div>
              <div class="stat-card__label">Sell Price per Lead</div>
              <div class="stat-card__description">What the client pays you per lead</div>
            </div>
            <div class="stat-card">
              <div class="stat-card__value">$110</div>
              <div class="stat-card__label">Gross Profit per Lead</div>
              <div class="stat-card__description">Your margin. Uncapped volume.</div>
            </div>
          </div>
        </div>
      </section>

      <!-- ==================== SLIDE 9: The Catch (Quote) ==================== -->
      <section class="slide slide--quote" data-slide="9" data-chapter="The Catch" data-notes="Tone shift — get serious here|This is where you earn trust by being honest|Pause after 'you lose money' — let it sink in">
        <div class="slide__content slide__content--centered">
          <div class="slide__quote-wrapper">
            <div class="slide__quote-mark">&ldquo;</div>
            <blockquote class="slide__quote">The risk is entirely on you. You pay for the ads. If the ads flop, you lose money.</blockquote>
            <cite class="slide__attribution">The catch that separates real operators from dreamers</cite>
          </div>
        </div>
      </section>

      <!-- ==================== SLIDE 10: Niche Scorecard ==================== -->
      <section class="slide slide--heading-bullets" data-slide="10" data-chapter="Niche Scorecard" data-notes="This is the actionable framework — go through each one|Stress #5 sales ops maturity — most people miss this|If a niche fails any of these, walk away">
        <div class="slide__content">
          <div class="badge badge--step">The Framework</div>
          <h2 class="slide__heading">5-Point Niche Scorecard</h2>
          <img class="slide__hero-image" src="images/slide-10-niche-scorecard.png" alt="Five-point niche evaluation scorecard checklist" />
          <p class="slide__subheading">If a niche doesn't pass all five, don't touch it</p>
          <ul class="slide__bullets">
            <li class="slide__bullet">Profit per client: $2K+ per closed deal</li>
            <li class="slide__bullet">Close rate: 15%+ lead-to-client conversion</li>
            <li class="slide__bullet">Platform fit: targetable on Facebook or Google</li>
            <li class="slide__bullet">Volume potential: scalable to 2K leads/mo</li>
          </ul>
        </div>
      </section>

      <!-- ==================== SLIDE 11: Sellable Asset ==================== -->
      <section class="slide slide--heading-bullets" data-slide="11" data-chapter="Sellable Asset" data-notes="This is the WHY behind everything|Retainer = you ARE the business. PPL = you OWN the business.|End with 'machine that prints leads on demand'">
        <div class="slide__content">
          <div class="badge badge--step">The Endgame</div>
          <h2 class="slide__heading">Build a Sellable Machine</h2>
          <img class="slide__hero-image" src="images/slide-11-sellable-asset.png" alt="Retainer agency tied to person vs PPL system as sellable machine" />
          <p class="slide__subheading">From service business to sellable asset</p>
          <ul class="slide__bullets">
            <li class="slide__bullet">Retainer value is tied to relationships</li>
            <li class="slide__bullet">PPL value is tied to data, pixel, and system</li>
            <li class="slide__bullet">A machine that prints leads on demand</li>
            <li class="slide__bullet">Systems sell. People don't.</li>
          </ul>
        </div>
      </section>

      <!-- ==================== SLIDE 12: Key Takeaways (Recap) ==================== -->
      <section class="slide slide--recap" data-slide="12" data-chapter="Key Takeaways" data-notes="Rapid-fire through these — energy up|Each one should feel like a punch|End with 'the system is the asset' as the final thought">
        <div class="slide__content">
          <h2 class="slide__heading">Key Takeaways</h2>
          <ol class="slide__takeaways">
            <li class="slide__takeaway">Retainers cap your income and chain you to clients</li>
            <li class="slide__takeaway">PPL flips the pitch: clients only pay for results</li>
            <li class="slide__takeaway">One pixel and one funnel beats twenty scattered ones</li>
            <li class="slide__takeaway">The math: $40 in, $150 out, $110 profit per lead</li>
            <li class="slide__takeaway">The risk is real — pick your niche with the 5-point scorecard</li>
            <li class="slide__takeaway">PPL agencies are sellable because the system is the asset</li>
          </ol>
        </div>
      </section>

      <!-- ==================== SLIDE 13: CTA (Title Slide) ==================== -->
      <section class="slide slide--title" data-slide="13" data-chapter="Next Steps" data-notes="Direct CTA — tell them exactly what to do|Mention the link in description|Ask for comments to drive engagement">
        <div class="slide__content slide__content--centered">
          <div class="badge badge--recommended">Let's Talk</div>
          <h1 class="slide__title">Ready to Build Your<br>Lead Machine?</h1>
          <p class="slide__subtitle">Book a call with Great Marketing AI and let us drive leads for your business</p>
          <div class="slide__cta">
            <p class="slide__cta-text">Drop a comment: Retainers or Pay-Per-Lead?</p>
          </div>
        </div>
      </section>

    </main><!-- /stage -->
  </div><!-- /presentation -->

  <!-- ===== Edit Toolbar ===== -->
  <div class="edit-toolbar">
    <button class="edit-toolbar__btn" data-action="bold"><strong>B</strong></button>
    <button class="edit-toolbar__btn" data-action="italic"><em>I</em></button>
    <div class="edit-toolbar__separator"></div>
    <button class="edit-toolbar__btn" data-action="font-up">A+</button>
    <button class="edit-toolbar__btn" data-action="font-down">A-</button>
    <div class="edit-toolbar__separator"></div>
    <button class="edit-toolbar__btn" data-action="add-bullet">+ Bullet</button>
    <button class="edit-toolbar__btn" data-action="remove-bullet">- Bullet</button>
    <div class="edit-toolbar__separator"></div>
    <button class="edit-toolbar__btn" data-action="add-slide">+ Slide</button>
    <button class="edit-toolbar__btn edit-toolbar__btn--danger" data-action="delete-slide">Delete Slide</button>
    <div class="edit-toolbar__spacer"></div>
    <button class="edit-toolbar__btn edit-toolbar__btn--save" data-action="save">Save</button>
  </div>

  <!-- ===== Edit Mode Indicator ===== -->
  <div class="edit-indicator">Edit Mode</div>

  <!-- ===== Slide Engine ===== -->
  <script>
/**
 * Slide Engine - Navigation, Edit Mode, Slide Management, and Fullscreen
 * Embedded in every generated HTML slide deck.
 */
(function () {
  'use strict';

  /* ------------------------------------------------------------------ */
  /*  State                                                              */
  /* ------------------------------------------------------------------ */
  let currentSlide = 0;
  let editMode = false;
  let isFullscreen = false;
  let notesVisible = false;
  let fileHandle = null;
  let slides = Array.from(document.querySelectorAll('.slide'));
  let sidebarItems = Array.from(document.querySelectorAll('.sidebar__item'));
  const progressFill = document.querySelector('.sidebar__progress-fill');
  const progressText = document.querySelector('.sidebar__progress-text');
  const presentation = document.querySelector('.presentation');
  const editToolbar = document.querySelector('.edit-toolbar');
  const editIndicator = document.querySelector('.edit-indicator');
  const stage = document.querySelector('.stage');
  const sidebarNav = document.querySelector('.sidebar__nav');

  function getTotalSlides() {
    return slides.length;
  }

  /* ------------------------------------------------------------------ */
  /*  Navigation                                                         */
  /* ------------------------------------------------------------------ */
  function goToSlide(index) {
    var total = getTotalSlides();
    if (index < 0 || index >= total) return;
    slides[currentSlide].classList.remove('slide--active');
    sidebarItems[currentSlide]?.classList.remove('sidebar__item--active');
    currentSlide = index;
    slides[currentSlide].classList.add('slide--active');
    sidebarItems[currentSlide]?.classList.add('sidebar__item--active');
    updateProgress();

    // Scroll sidebar item into view
    sidebarItems[currentSlide]?.scrollIntoView({ block: 'nearest', behavior: 'smooth' });

    // Update talking points if visible
    if (notesVisible) updateNotesContent();
  }

  function nextSlide() {
    goToSlide(currentSlide + 1);
  }

  function prevSlide() {
    goToSlide(currentSlide - 1);
  }

  function updateProgress() {
    var total = getTotalSlides();
    var pct = ((currentSlide + 1) / total) * 100;
    if (progressFill) progressFill.style.width = pct + '%';
    if (progressText) progressText.textContent = (currentSlide + 1) + ' / ' + total;
  }

  // Sidebar click handlers
  function bindSidebarClicks() {
    sidebarItems.forEach(function (item, i) {
      item.onclick = function () {
        goToSlide(i);
      };
    });
  }
  bindSidebarClicks();

  /* ------------------------------------------------------------------ */
  /*  Sidebar Renumbering                                                */
  /* ------------------------------------------------------------------ */
  function renumberSidebar() {
    sidebarItems = Array.from(document.querySelectorAll('.sidebar__item'));
    sidebarItems.forEach(function (item, i) {
      var numEl = item.querySelector('.sidebar__item-number');
      if (numEl) numEl.textContent = String(i + 1).padStart(2, '0');
    });
    bindSidebarClicks();
  }

  /* ------------------------------------------------------------------ */
  /*  Edit Mode                                                          */
  /* ------------------------------------------------------------------ */
  const editableSelectors = [
    '.slide__title', '.slide__heading', '.slide__subheading',
    '.slide__subtitle', '.slide__description', '.slide__bullet',
    '.slide__quote', '.slide__attribution', '.card__title',
    '.card__description', '.stat-card__value', '.stat-card__label',
    '.stat-card__description', '.slide__takeaway', '.slide__cta-text',
    '.badge'
  ];

  function enableEditMode() {
    editMode = true;
    presentation.classList.add('edit-mode');
    document.querySelectorAll(editableSelectors.join(', ')).forEach(function (el) {
      el.setAttribute('contenteditable', 'true');
    });
    addImageOverlays();
    addDragHandles();
  }

  function disableEditMode() {
    editMode = false;
    presentation.classList.remove('edit-mode');
    document.querySelectorAll('[contenteditable="true"]').forEach(function (el) {
      el.removeAttribute('contenteditable');
    });
    removeImageOverlays();
    removeDragHandles();
  }

  function toggleEditMode() {
    if (editMode) {
      disableEditMode();
    } else {
      enableEditMode();
    }
  }

  /* Image replace overlays */
  function addImageOverlays() {
    document.querySelectorAll('.slide__image, .slide__hero-image').forEach(function (img) {
      if (img.parentElement.querySelector('.image-replace-overlay')) return;
      var wrapper = document.createElement('div');
      wrapper.style.position = 'relative';
      wrapper.style.display = 'inline-block';
      img.parentNode.insertBefore(wrapper, img);
      wrapper.appendChild(img);

      var overlay = document.createElement('div');
      overlay.className = 'image-replace-overlay';
      var btn = document.createElement('button');
      btn.className = 'image-replace-btn';
      btn.textContent = 'Replace Image';
      btn.addEventListener('click', function () {
        var url = prompt('Paste new image URL (or base64 data URI):');
        if (url) img.src = url;
      });
      overlay.appendChild(btn);
      wrapper.appendChild(overlay);
    });
  }

  function removeImageOverlays() {
    document.querySelectorAll('.image-replace-overlay').forEach(function (overlay) {
      var wrapper = overlay.parentElement;
      var img = wrapper.querySelector('.slide__image, .slide__hero-image');
      if (img && wrapper.parentElement) {
        wrapper.parentElement.insertBefore(img, wrapper);
        wrapper.remove();
      }
    });
  }

  /* ------------------------------------------------------------------ */
  /*  Drag and Drop Reordering (Edit Mode)                               */
  /* ------------------------------------------------------------------ */
  var dragState = null;

  function addDragHandles() {
    document.querySelectorAll('.slide__content > *').forEach(function (el) {
      if (el.querySelector('.drag-handle')) return;
      var handle = document.createElement('div');
      handle.className = 'drag-handle';
      handle.addEventListener('mousedown', function (e) {
        startDrag(e, el);
      });
      el.appendChild(handle);
    });
  }

  function removeDragHandles() {
    if (dragState) handleDragEnd();
    document.querySelectorAll('.drag-handle').forEach(function (handle) {
      handle.remove();
    });
  }

  function startDrag(e, el) {
    e.preventDefault();
    dragState = { el: el, container: el.parentElement };
    el.classList.add('dragging');
    document.addEventListener('mousemove', handleDragMove);
    document.addEventListener('mouseup', handleDragEnd);
  }

  function handleDragMove(e) {
    if (!dragState) return;
    e.preventDefault();
    var container = dragState.container;
    var dragEl = dragState.el;
    var children = Array.from(container.children);
    for (var i = 0; i < children.length; i++) {
      var child = children[i];
      if (child === dragEl) continue;
      var rect = child.getBoundingClientRect();
      var midY = rect.top + rect.height / 2;
      if (e.clientY < midY) {
        container.insertBefore(dragEl, child);
        return;
      }
    }
    container.appendChild(dragEl);
  }

  function handleDragEnd() {
    if (!dragState) return;
    dragState.el.classList.remove('dragging');
    dragState = null;
    document.removeEventListener('mousemove', handleDragMove);
    document.removeEventListener('mouseup', handleDragEnd);
  }

  /* ------------------------------------------------------------------ */
  /*  Slide Management (Add / Delete)                                    */
  /* ------------------------------------------------------------------ */
  function addSlide() {
    if (!editMode) return;

    var newNum = currentSlide + 2;

    var section = document.createElement('section');
    section.className = 'slide slide--heading-bullets';
    section.setAttribute('data-slide', String(newNum));
    section.setAttribute('data-chapter', 'New Slide');
    section.setAttribute('data-notes', '');
    section.innerHTML =
      '<div class="slide__content">' +
        '<div class="badge badge--step" contenteditable="true">New Section</div>' +
        '<h2 class="slide__heading" contenteditable="true">Slide Title</h2>' +
        '<p class="slide__subheading" contenteditable="true">Subtitle goes here</p>' +
        '<ul class="slide__bullets">' +
          '<li class="slide__bullet" contenteditable="true">First point</li>' +
          '<li class="slide__bullet" contenteditable="true">Second point</li>' +
          '<li class="slide__bullet" contenteditable="true">Third point</li>' +
        '</ul>' +
      '</div>';

    var currentSlideEl = slides[currentSlide];
    if (currentSlideEl.nextElementSibling) {
      stage.insertBefore(section, currentSlideEl.nextElementSibling);
    } else {
      stage.appendChild(section);
    }

    var li = document.createElement('li');
    li.className = 'sidebar__item';
    li.innerHTML =
      '<span class="sidebar__item-number">' + String(newNum).padStart(2, '0') + '</span>' +
      '<span class="sidebar__item-label">New Slide</span>';

    var currentSidebarItem = sidebarItems[currentSlide];
    if (currentSidebarItem && currentSidebarItem.nextElementSibling) {
      sidebarNav.insertBefore(li, currentSidebarItem.nextElementSibling);
    } else {
      sidebarNav.appendChild(li);
    }

    slides = Array.from(document.querySelectorAll('.slide'));
    renumberSidebar();
    updateProgress();
    goToSlide(currentSlide + 1);
  }

  function deleteSlide() {
    if (!editMode) return;
    var total = getTotalSlides();
    if (total <= 1) return;

    if (!confirm('Delete this slide?')) return;

    var slideToRemove = slides[currentSlide];
    var sidebarToRemove = sidebarItems[currentSlide];
    var targetIndex = currentSlide;

    if (currentSlide >= total - 1) {
      targetIndex = currentSlide - 1;
    }

    slideToRemove.classList.remove('slide--active');
    if (sidebarToRemove) sidebarToRemove.classList.remove('sidebar__item--active');

    slideToRemove.remove();
    if (sidebarToRemove) sidebarToRemove.remove();

    slides = Array.from(document.querySelectorAll('.slide'));
    renumberSidebar();

    currentSlide = Math.max(0, Math.min(targetIndex, getTotalSlides() - 1));
    slides[currentSlide].classList.add('slide--active');
    sidebarItems[currentSlide]?.classList.add('sidebar__item--active');
    updateProgress();
  }

  /* ------------------------------------------------------------------ */
  /*  Toolbar Actions                                                    */
  /* ------------------------------------------------------------------ */
  function execCommand(cmd) {
    document.execCommand(cmd, false, null);
  }

  function changeFontSize(delta) {
    var sel = window.getSelection();
    if (!sel.rangeCount) return;
    var el = sel.anchorNode?.parentElement;
    if (!el) return;
    var current = parseFloat(window.getComputedStyle(el).fontSize);
    el.style.fontSize = (current + delta) + 'px';
  }

  function addBullet() {
    var activeSlide = slides[currentSlide];
    var list = activeSlide.querySelector('.slide__bullets, .slide__takeaways');
    if (!list) return;
    var item = document.createElement('li');
    item.className = list.querySelector('li')?.className || '';
    item.textContent = 'New item';
    item.setAttribute('contenteditable', 'true');
    list.appendChild(item);
    item.focus();
  }

  function removeBullet() {
    var activeSlide = slides[currentSlide];
    var list = activeSlide.querySelector('.slide__bullets, .slide__takeaways');
    if (!list) return;
    var items = list.querySelectorAll('li');
    if (items.length > 1) {
      items[items.length - 1].remove();
    }
  }

  /* ------------------------------------------------------------------ */
  /*  Save Presentation                                                  */
  /* ------------------------------------------------------------------ */
  function savePresentation() {
    var wasEditing = editMode;
    if (wasEditing) disableEditMode();

    var notesPanel = document.querySelector('.notes-panel');
    if (notesPanel) notesPanel.style.display = 'none';

    var html = '<!DOCTYPE html>\n' + document.documentElement.outerHTML;

    if (notesPanel && notesVisible) notesPanel.style.display = 'block';

    if (wasEditing) enableEditMode();

    if (window.showSaveFilePicker) {
      saveWithFileSystemAccess(html);
    } else {
      saveWithDownload(html);
    }
  }

  function saveWithFileSystemAccess(html) {
    if (fileHandle) {
      writeToHandle(fileHandle, html);
    } else {
      var suggestedName = document.title.replace(/\s+/g, '-').toLowerCase() + '.html';
      window.showSaveFilePicker({
        suggestedName: suggestedName,
        types: [{
          description: 'HTML Files',
          accept: { 'text/html': ['.html'] }
        }]
      }).then(function (handle) {
        fileHandle = handle;
        writeToHandle(handle, html);
      }).catch(function (err) {
        if (err.name !== 'AbortError') {
          console.error('Save failed:', err);
          showToast('Save failed', true);
        }
      });
    }
  }

  function writeToHandle(handle, content) {
    handle.createWritable().then(function (writable) {
      return writable.write(content).then(function () {
        return writable.close();
      });
    }).then(function () {
      showToast('Saved!');
    }).catch(function (err) {
      console.error('Write failed:', err);
      showToast('Save failed', true);
      fileHandle = null;
    });
  }

  function saveWithDownload(html) {
    var blob = new Blob([html], { type: 'text/html' });
    var a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = document.title.replace(/\s+/g, '-').toLowerCase() + '.html';
    a.click();
    URL.revokeObjectURL(a.href);
    showToast('Downloaded!');
  }

  /* ------------------------------------------------------------------ */
  /*  Toast Notifications                                                */
  /* ------------------------------------------------------------------ */
  function showToast(message, isError) {
    var existing = document.querySelector('.save-toast');
    if (existing) existing.remove();

    var toast = document.createElement('div');
    toast.className = 'save-toast' + (isError ? ' save-toast--error' : '');
    toast.textContent = message;
    document.body.appendChild(toast);

    requestAnimationFrame(function () {
      toast.classList.add('save-toast--visible');
    });

    setTimeout(function () {
      toast.classList.remove('save-toast--visible');
      setTimeout(function () { toast.remove(); }, 300);
    }, 2000);
  }

  /* ------------------------------------------------------------------ */
  /*  Talking Points Panel                                               */
  /* ------------------------------------------------------------------ */
  function createNotesPanel() {
    var panel = document.createElement('div');
    panel.className = 'notes-panel';
    panel.innerHTML =
      '<div class="notes-panel__header">' +
        '<span class="notes-panel__title">Talking Points</span>' +
        '<span class="notes-panel__hint">T</span>' +
        '<button class="notes-panel__close">&times;</button>' +
      '</div>' +
      '<ul class="notes-panel__list"></ul>';
    panel.style.display = 'none';
    document.body.appendChild(panel);

    panel.querySelector('.notes-panel__close').addEventListener('click', function () {
      toggleNotes();
    });

    return panel;
  }

  var notesPanelEl = createNotesPanel();

  function updateNotesContent() {
    var list = notesPanelEl.querySelector('.notes-panel__list');
    var currentSlideEl = slides[currentSlide];
    var notesData = currentSlideEl ? currentSlideEl.dataset.notes : '';

    if (!notesData || notesData.trim() === '') {
      list.innerHTML = '<li class="notes-panel__empty">No notes for this slide</li>';
      return;
    }

    var points = notesData.split('|').map(function (s) { return s.trim(); }).filter(Boolean);
    list.innerHTML = points.map(function (p) {
      return '<li class="notes-panel__item">' + p + '</li>';
    }).join('');
  }

  function toggleNotes() {
    notesVisible = !notesVisible;
    notesPanelEl.style.display = notesVisible ? 'block' : 'none';
    if (notesVisible) updateNotesContent();
  }

  // Bind toolbar buttons
  document.querySelectorAll('.edit-toolbar__btn').forEach(function (btn) {
    var action = btn.dataset.action;
    if (!action) return;
    btn.addEventListener('click', function (e) {
      e.preventDefault();
      switch (action) {
        case 'bold': execCommand('bold'); break;
        case 'italic': execCommand('italic'); break;
        case 'font-up': changeFontSize(2); break;
        case 'font-down': changeFontSize(-2); break;
        case 'add-bullet': addBullet(); break;
        case 'remove-bullet': removeBullet(); break;
        case 'add-slide': addSlide(); break;
        case 'delete-slide': deleteSlide(); break;
        case 'save': savePresentation(); break;
      }
    });
  });

  /* ------------------------------------------------------------------ */
  /*  Fullscreen                                                         */
  /* ------------------------------------------------------------------ */
  function toggleFullscreen() {
    if (!document.fullscreenElement) {
      document.documentElement.requestFullscreen().then(function () {
        isFullscreen = true;
        presentation.classList.add('presentation--fullscreen');
      }).catch(function () {});
    } else {
      document.exitFullscreen();
      isFullscreen = false;
      presentation.classList.remove('presentation--fullscreen');
    }
  }

  document.addEventListener('fullscreenchange', function () {
    if (!document.fullscreenElement) {
      isFullscreen = false;
      presentation.classList.remove('presentation--fullscreen');
    }
  });

  /* ------------------------------------------------------------------ */
  /*  Keyboard Shortcuts                                                 */
  /* ------------------------------------------------------------------ */
  document.addEventListener('keydown', function (e) {
    var isEditing = e.target.isContentEditable;

    if ((e.ctrlKey || e.metaKey) && e.key === 's') {
      e.preventDefault();
      savePresentation();
      return;
    }

    if ((e.ctrlKey || e.metaKey) && e.key === 'e') {
      e.preventDefault();
      toggleEditMode();
      return;
    }

    if ((e.ctrlKey || e.metaKey) && e.key === 'd') {
      if (editMode) {
        e.preventDefault();
        deleteSlide();
        return;
      }
    }

    if (e.key === 'Escape') {
      if (editMode) {
        disableEditMode();
      }
      return;
    }

    if (isEditing) return;

    switch (e.key) {
      case 'ArrowRight':
      case 'ArrowDown':
        e.preventDefault();
        nextSlide();
        break;
      case 'ArrowLeft':
      case 'ArrowUp':
        e.preventDefault();
        prevSlide();
        break;
      case 'f':
      case 'F11':
        e.preventDefault();
        toggleFullscreen();
        break;
      case 't':
        e.preventDefault();
        toggleNotes();
        break;
      case 'Home':
        e.preventDefault();
        goToSlide(0);
        break;
      case 'End':
        e.preventDefault();
        goToSlide(getTotalSlides() - 1);
        break;
    }
  });

  /* ------------------------------------------------------------------ */
  /*  Touch / Swipe Support                                              */
  /* ------------------------------------------------------------------ */
  var touchStartX = 0;
  document.addEventListener('touchstart', function (e) {
    touchStartX = e.changedTouches[0].screenX;
  }, { passive: true });

  document.addEventListener('touchend', function (e) {
    var diff = e.changedTouches[0].screenX - touchStartX;
    if (Math.abs(diff) > 50) {
      if (diff > 0) prevSlide();
      else nextSlide();
    }
  }, { passive: true });

  /* ------------------------------------------------------------------ */
  /*  Initialize                                                         */
  /* ------------------------------------------------------------------ */
  goToSlide(0);
})();
  </script>
</body>
</html>
